import React, { memo, useEffect, useState, useRef} from "react";

function useInterval(callback, delay) {
  const savedCallback = useRef();

  // Remember the latest callback.
  useEffect(() => {
    savedCallback.current = callback;
  }, [callback]);

  // Set up the interval.
  useEffect(() => {
    let id = setInterval(() => {
      savedCallback.current();
    }, delay);
    return () => clearInterval(id);
  }, [delay]);
}

const Suzuka = () => {
  const [distance, setDistance] = useState(0);
  const [position, setPosition] = useState({x:0, y:0})


  useInterval(() => {
    setDistance(distance + 10);
    console.log('distance', distance)
  }, 500);


  useEffect(() => {
    let track = document.getElementById("track");
    let totalLength = track.getTotalLength();
    let p = track.getPointAtLength(distance );
    setPosition({x: p.x, y:p.y})
  }, [distance]);

  return (
    <svg width="210px" height="297px" viewBox="0 0 210 297" version="1.1">
      <g>
        <path
          fill="none"
          stroke="#000000"
          strokeWidth="3.73771"
          d="M 82.031499,96.633955 122.58494,18.092463 c 0,0 3.08011,-5.62307 4.9438,-7.402676 0.39582,-0.377302 2.19437,-2.5597211 5.2265,-3.6487026 3.28874,-1.1811498 7.64716,-1.3668189 7.64716,-1.3668189 0,0 2.7452,-0.2129184 3.60158,-0.1044536 2.48759,0.3118893 11.37078,3.7761967 6.04429,12.2976711 -0.83712,1.339492 -9.33541,13.375307 -9.33541,13.375307 0,0 -3.73347,5.174113 -4.2049,6.929483 -0.55472,2.068105 -0.3318,4.689424 1.45483,7.741376 5.19947,8.880959 -0.54144,12.544308 -5.47314,16.24052 -2.93582,2.200918 -12.38259,7.159441 -5.5753,17.890854 6.56789,10.353644 -1.5824,17.003208 -5.88973,17.836248 -0.98171,0.1894 -12.65305,1.101815 -12.65305,1.101815 0,0 -8.473975,0.598677 -9.704784,9.070154 -0.183381,1.26175 0.273827,8.00236 0.395646,9.53597 1.291408,16.29494 16.428228,22.5881 23.921708,24.29187 1.76046,0.39996 10.4275,2.3777 10.4275,2.3777 l 9.51068,2.1635 c 0,0 1.40081,0.2714 2.28296,0.85918 0.62876,0.41909 1.55096,2.10446 1.55096,2.10446 l 5.54545,8.36133 c 0,0 2.20125,3.2602 2.9838,4.5001 1.07667,1.70565 1.22786,3.64693 -0.31234,5.15212 -1.4702,1.43679 -27.83317,18.70903 -27.83317,18.70903 0,0 -4.3605,3.31388 -6.1491,4.0687 -2.07935,0.87623 -6.77998,1.28854 -6.77998,1.28854 l -5.0998,0.43779 -6.02368,0.35105 c 0,0 -5.034085,-0.0993 -4.213156,3.15084 0.376648,1.48984 3.180846,2.06777 3.180846,2.06777 l 16.21672,1.81791 c 0,0 2.85682,0.31295 7.60523,1.57162 9.9948,2.64937 16.0322,9.63274 19.40158,20.41905 0.74935,2.39839 1.20982,5.68263 1.20982,5.68263 0,0 1.24035,7.46114 1.25946,10.19562 0.0542,7.67752 -2.24671,14.0365 -7.49661,20.2782 -4.4222,5.2576 -14.82409,15.42072 -14.82409,15.42072 0,0 -4.32141,4.49959 -1.81776,10.05477 0.92215,2.0461 4.02543,5.54306 4.02543,5.54306 0,0 7.96427,11.03555 17.10833,0.37751 3.99866,-4.66212 7.41843,-25.42687 7.41843,-25.42687 0,0 1.49288,-7.67378 1.41667,-16.57228 -0.0881,-10.21406 -7.02666,-68.68975 -7.02666,-68.68975 0,0 -0.94001,-9.44199 -1.64906,-10.82897 -2.52504,-4.93703 -13.32766,-12.39121 -16.51215,-13.98112 -0.57084,-0.28511 -5.11012,-2.1788 -5.11012,-2.1788 l -26.457652,-9.82897 c 0,0 -3.95305,-1.04453 -4.322328,-3.98456 -0.09407,-0.74721 0.804375,-2.51528 0.804375,-2.51528 0,0 1.193331,-3.00156 -0.900005,-4.12864 -2.292914,-1.23357 -5.29887,-2.47453 -5.29887,-2.47453 0,0 -7.430551,-3.93204 -8.652744,-10.89501 -0.726695,-4.14345 -1.786613,-10.42 3.578393,-20.695545 z"
          id="track"
          style={{
            stroke: "black",
            strokeOpacity: 0.5,
            strokeWidth: 3,
          }}
        />
        <circle r="5" cy="0" cx="0" id="car" style={{ fill: "#dd1819", transform: `translate(${position.x}, ${position.y})` }} />
      </g>
    </svg>
  );
};

export default Suzuka;
